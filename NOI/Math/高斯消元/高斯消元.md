# 高斯消元

给定$a_{ij}\;(i,j=1,...,n)$，再给定$b_i(i=1,...,n)$，求解方程组：
$$
\begin{align*}
a_{11}x_1+a_{12}x_2+...+a_{1n}x_n &= b_1 \\
a_{21}x_1+a_{22}x_2+...+a_{2n}x_n &= b_2 \\
& \vdots\\
a_{n1}x_1+a_{n2}x_2+...+a_{nn}x_n &= b_n
\end{align*}
$$

一共有$x_1,...,x_n$共$n$个未知数，有$n$个方程。

$$
x_1+2x_2=5 \\
2x_1+4x_2=10
$$

这个方程是“欠定”的，存在无穷多个解。

$$
x_1+2x_2=5 \\
x_1+4x_2=10 \\
x_1+2x_2=6
$$

这个方程是“超定”的，它不存在解。

假如说一个方程组存在唯一解，我们就说这个方程组是“适定”的。

`A[i][j]` = $a_{ij}$，`A[i][n+1]` = $b_i$

我们可以把 `A` 任意一行乘上某个数后加给另一行。

把 `A` 第一行的 $-\frac{a_{21}}{a_{11}}$ 倍 加给第二行

把 `A` 第一行的 $-\frac{a_{31}}{a_{11}}$ 倍 加给第三行

一直处理到第$n$行

在第$2$到第$n$行中，找到一个第二个数非零的行，跟第二行做交换（这是为了保证$a_{22}\neq 0$）

**注意：如果这时候找不到第二个数非零的行，说明方程不存在唯一解**

把 `A` 第二行的 $-\frac{a_{32}}{a_{22}}$ 倍 加给第三行

把 `A` 第二行的 $-\frac{a_{42}}{a_{22}}$ 倍 加给第四行

一直处理到第$n$行

一直重复……直到：

$$
\begin{align*}
a_{11}x_1+a_{12}x_2+...+a_{1n}x_n &= b_1 \\
a_{22}x_2+...+a_{2n}x_n &= b_2 \\
& \vdots\\
a_{nn}x_n &= b_n
\end{align*}
$$

然后从下往上回代，算出全部未知数。

复杂度：$O(n^3)$，常数是非常小的，大概是$1/8$

模板题就解决了。有一个更难的问题，虽然没什么用，但可以想想：

在没有唯一解的情况下，如何判断是欠定（有无穷多个解）还是超定（方程冲突，没有解）？

## 高斯消元（取模版）

给定$a_{ij}\;(i,j=1,...,n)$，再给定$b_i(i=1,...,n)$，求解方程组：
$$
\begin{align*}
a_{11}x_1+a_{12}x_2+...+a_{1n}x_n &\equiv b_1 \;\;(mod \;p) \\
a_{21}x_1+a_{22}x_2+...+a_{2n}x_n &\equiv b_2 \;\;(mod \;p)\\
& \vdots\\
a_{n1}x_1+a_{n2}x_2+...+a_{nn}x_n &\equiv b_n \;\;(mod \;p)
\end{align*}
$$

$p$是给定的质数。

只要把除法改成逆元就好了。

取$p=10^9+7$，算一下`data.in`，看能不能算对。